name: Sincronizar Conte√∫do

on:
  push:
    branches:
      - main
    paths:
      - 'content/**'
      - 'assets/**'

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout conte√∫do
        uses: actions/checkout@v4
        with:
          path: content-repo

      - name: Checkout projeto
        uses: actions/checkout@v4
        with:
          repository: Skedar/gamedesigner.space
          token: ${{ secrets.PAT_TOKEN }}
          path: project-repo

      - name: Configurar Git
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'

      - name: Sincronizar conte√∫do
        run: |
          # Remover conte√∫do antigo do projeto
          rm -rf project-repo/src/content
          rm -rf project-repo/src/assets

          # Copiar novo conte√∫do
          cp -r content-repo/content project-repo/src
          cp -r content-repo/assets project-repo/src
          # Entrar no diret√≥rio do projeto
          cd project-repo

          # Verificar se h√° mudan√ßas
          if [[ -n "$(git status --porcelain)" ]]; then
            # Adicionar mudan√ßas
            git add content assets
            
            # Commit com mensagem descritiva
            git commit -m "ü§ñ Sync: Atualiza√ß√£o autom√°tica de conte√∫do
            
            Altera√ß√µes sincronizadas do reposit√≥rio de conte√∫do
            Commit original: ${{ github.sha }}"
            
            # Push das altera√ß√µes
            git push
          else
            echo "Nenhuma altera√ß√£o detectada"
          fi 